(function(c,C){typeof exports=="object"&&typeof module<"u"?C(exports):typeof define=="function"&&define.amd?define(["exports"],C):(c=typeof globalThis<"u"?globalThis:c||self,C(c.Datastar={}))})(this,function(c){"use strict";function C(e,t){if(e)for(t(e),e=e.firstElementChild;e;)C(e,t),e=e.nextElementSibling}function j(e,t){e&&(t(e),e=e.parentElement,j(e,t))}function L(e){const t=`return ${e}`;return new Function("el","dataStack","actions",t)}function re(e,t,n,s){const r=L(s);try{return r(e,t,n)}catch{console.error(`Error evaluating expression: ${s}`)}}function oe(e){return e.replace(/(?:^\w|[A-Z]|\b\w)/g,(t,n)=>n===0?t.toLowerCase():t.toUpperCase()).replace(/\s+/g,"")}let k,g=null,v=0,P=[],V,W=!1;const F=0,ie=1,R=2;function Z(e,t){const n=new ae(e,t?.effect);return t?.equals&&(n.equals=t.equals),n}function lt(e,t){return e===t}class ae{constructor(t,n=!1){this.isEffect=n,typeof t=="function"?(this.fn=t,this._value=void 0,this.isEffect=n||!1,this.state=R,n&&(P.push(this),V?.(this))):(this.fn=void 0,this._value=t,this.state=F,this.isEffect=!1)}_value;fn;observers=null;sources=null;state;cleanups=[];equals=lt;get value(){return this.get()}set value(t){this.set(t)}get(){return k&&(!g&&k.sources&&k.sources[v]==this?v++:g?g.push(this):g=[this]),this.fn&&this.updateIfNecessary(),this._value}set(t){if(typeof t=="function"){const n=t;n!==this.fn&&this.stale(R),this.fn=n}else{this.fn&&(this.removeParentObservers(0),this.sources=null,this.fn=void 0);const n=t;if(!this.equals(this._value,n)){if(this.observers)for(let s=0;s<this.observers.length;s++)this.observers[s].stale(R);this._value=n}}}stale(t){if(this.state<t&&(this.state===F&&this.isEffect&&(P.push(this),V?.(this)),this.state=t,this.observers))for(let n=0;n<this.observers.length;n++)this.observers[n].stale(ie)}update(){const t=this._value,n=k,s=g,r=v;k=this,g=null,v=0;try{if(this.cleanups.length&&(this.cleanups.forEach(o=>o(this._value)),this.cleanups=[]),this._value=this.fn(),g){if(this.removeParentObservers(v),this.sources&&v>0){this.sources.length=v+g.length;for(let o=0;o<g.length;o++)this.sources[v+o]=g[o]}else this.sources=g;for(let o=v;o<this.sources.length;o++){const i=this.sources[o];i.observers?i.observers.push(this):i.observers=[this]}}else this.sources&&v<this.sources.length&&(this.removeParentObservers(v),this.sources.length=v)}finally{g=s,k=n,v=r}if(!this.equals(t,this._value)&&this.observers)for(let o=0;o<this.observers.length;o++){const i=this.observers[o];i.state=R}this.state=F}updateIfNecessary(){if(this.state===ie){for(const t of this.sources)if(t.updateIfNecessary(),this.state===R)break}this.state===R&&this.update(),this.state=F}removeParentObservers(t){if(this.sources)for(let n=t;n<this.sources.length;n++){const s=this.sources[n],r=s.observers.findIndex(o=>o===this);s.observers[r]=s.observers[s.observers.length-1],s.observers.pop()}}}function ct(e){k?k.cleanups.push(e):console.error("onCleanup must be called from within a @reactive function")}function ut(){for(let e=0;e<P.length;e++)P[e].get();P.length=0}function ft(e=dt){V=e}function dt(){W||(W=!0,queueMicrotask(()=>{W=!1,ut()}))}ft();function ht(e){return Z(e)}function pt(e){return Z(e)}function mt(e){return Z(e,{effect:!0})}new MutationObserver(e=>{for(const t of e)t.removedNodes.forEach(n=>{const s=n;s&&J.delete(s)}),t.addedNodes.forEach(n=>{const s=n;s&&ce.forEach(r=>r(s))})}).observe(document,{attributes:!0,childList:!0,subtree:!0});function le({regexp:e,replacer:t},n){const s=[...n.matchAll(e)];if(!s.length)return n;for(const r of s){if(!r.groups)continue;const{groups:o}=r,{whole:i}=o;n=n.replace(i,t(o))}return n}function Et(e,t=0){let n=3735928559^t,s=1103547991^t;for(let r=0,o;r<e.length;r++)o=e.charCodeAt(r),n=Math.imul(n^o,2654435761),s=Math.imul(s^o,1597334677);return n=Math.imul(n^n>>>16,2246822507),n^=Math.imul(s^s>>>13,3266489909),s=Math.imul(s^s>>>16,2246822507),s^=Math.imul(n^n>>>13,3266489909),4294967296*(2097151&s)+(n>>>0)}const x=new Map,ce=new Map,J=new Map,ue=new Array,X=new Map,K={};function b(e,t){if(e.toLowerCase()!==e)throw Error(`Data extension 'data-${e}' must be lowercase`);if(x.has(e))throw new Error(`Data extension 'data-${e}' already registered`);const n=Et(e);x.set(e,n),t||(t={});for(const l of t.requiredExtensions||[])if(l===e)throw new Error(`Data extension 'data-${e}' cannot require itself`);const s=new Set(x.keys());for(const l of t.requiredExtensions||[])if(!s.has(l))throw new Error(`Data extension 'data-${e}' can't be a duplicate`);typeof t?.isPreprocessGlobal>"u"&&(t.isPreprocessGlobal=!0),t?.preprocessExpressions&&t.isPreprocessGlobal&&ue.push(...t.preprocessExpressions);const r=[];if(t?.allowedModifiers)for(const l of t.allowedModifiers){const u=l instanceof RegExp?l:new RegExp(l);r.push(u)}const o=new Set([...t?.allowedTags||[]].map(l=>l.toLowerCase()));function i(l){C(l,u=>{const f=H(u);if(!f)return;let a=J.get(f);if(a||(a=new Set,J.set(f,a)),!a.has(n)){if(a.add(n),o.size){const E=f.tagName.toLowerCase();if(!o.has(E))return}for(var d in f.dataset){if(!d.startsWith(e))continue;let[E,...m]=d.split(".");const h=e.length,y=h+1;E=E.slice(h,y).toLocaleLowerCase()+E.slice(y);const T=m.map(w=>{const[p,...I]=w.split(":");if(!r.some(at=>at.test(p)))throw new Error(`Modifier ${p} is not allowed for ${E}`);return{label:p,args:I}}),A=wt(f);let D=f.dataset[d]||"";for(const w of ue)D=le(w,D);if(t?.preprocessExpressions&&!t?.isPreprocessGlobal)for(const w of t.preprocessExpressions)D=le(w,D);const M=X.get(f)||{};if(t?.withExpression){const w=t.withExpression({name:E,expression:D,el:f,dataStack:A,reactivity:{signal:ht,computed:pt,effect:mt,onCleanup:ct},withMod:p=>gt(T,p),hasMod:p=>vt(T,p),actions:K});w&&Object.assign(M,w)}X.set(f,M)}}})}i(document.body),ce.set(n,i)}function wt(e){const t=[];j(e,s=>{const r=X.get(s);r&&t.push(r)}),t.reverse();const n={};for(const s of t)for(const r in s)n[r]||(n[r]={}),Object.assign(n[r],s[r]);return n}function H(e){return e instanceof HTMLElement||e instanceof SVGElement?e:null}function vt(e,t){return e.some(n=>n.label===t)}function gt(e,t){return e.find(n=>n.label===t)}function bt(e){const{name:t,fn:n,requiredExtensions:s}=e,r=[Y,...s||[]];if(t!=oe(t))throw new Error("must be camelCase");for(const o of r){if(!x.has(o))throw new Error(`requires '@${t}' registration`);if(t in K)throw new Error(`'@${t}' already registered`);K[t]=n}}let St=0;function yt(){return St++}const Y="action";function Tt(){b(Y,{preprocessExpressions:[{name:"action",description:"turns @action(args) into actions.action(args)",regexp:new RegExp(/(?<whole>@(?<action>[a-zA-Z_$][0-9a-zA-Z_$]*)(?<call>\((?<args>.*)\))?)/g),replacer:({action:e,args:t})=>`actions.${e}({el,dataStack, actions}, ${t||""})`}]})}const fe="bind";function de(){b(fe,{requiredExtensions:[S],withExpression:({el:e,name:t,expression:n,dataStack:s,actions:r,reactivity:{effect:o}})=>{const i=L(n);return{bind:{[t]:o(()=>{if(!s?.signals)return;const u=i(e,s,r);e.setAttribute(t,`${u}`)})}}}})}const he="focus";function pe(){b(he,{requiredExtensions:[S],withExpression:({el:e})=>{const t=H(e);if(!t?.focus)throw new Error("Element must have a focus method");return t.focus(),{}}})}const _=new WeakSet;function Mt(e,t,n={}){e instanceof Document&&(e=e.documentElement);let s;typeof t=="string"?s=Nt(t):s=t;const r=Ct(s),o=Dt(e,r,n);return me(e,r,o)}function me(e,t,n){if(n.head.block){const s=e.querySelector("head"),r=t.querySelector("head");if(s&&r){const o=we(r,s,n);Promise.all(o).then(()=>{me(e,t,Object.assign(n,{head:{block:!1,ignore:!0}}))});return}}if(n.morphStyle==="innerHTML")return Ee(t,e,n),e.children;if(n.morphStyle==="outerHTML"||n.morphStyle==null){const s=Rt(t,e,n);if(!s)throw new Error("Could not find best match");const r=s?.previousSibling,o=s?.nextSibling,i=G(e,s,n);return s?Ot(r,i,o):[]}else throw"Do not understand how to morph style "+n.morphStyle}function G(e,t,n){if(!(n.ignoreActive&&e===document.activeElement))if(t==null){if(n.callbacks.beforeNodeRemoved(e)===!1)return;e.remove(),n.callbacks.afterNodeRemoved(e);return}else{if(B(e,t))return n.callbacks.beforeNodeMorphed(e,t)===!1?void 0:(e instanceof HTMLHeadElement&&n.head.ignore||(t instanceof HTMLHeadElement&&e instanceof HTMLHeadElement&&n.head.style!=="morph"?we(t,e,n):(At(t,e),Ee(t,e,n))),n.callbacks.afterNodeMorphed(e,t),e);if(n.callbacks.beforeNodeRemoved(e)===!1||n.callbacks.beforeNodeAdded(t)===!1)return;if(!e.parentElement)throw new Error("oldNode has no parentElement");return e.parentElement.replaceChild(t,e),n.callbacks.afterNodeAdded(t),n.callbacks.afterNodeRemoved(e),t}}function Ee(e,t,n){let s=e.firstChild,r=t.firstChild,o;for(;s;){if(o=s,s=o.nextSibling,r==null){if(n.callbacks.beforeNodeAdded(o)===!1)return;t.appendChild(o),n.callbacks.afterNodeAdded(o),O(n,o);continue}if(ve(o,r,n)){G(r,o,n),r=r.nextSibling,O(n,o);continue}let i=Lt(e,t,o,r,n);if(i){r=ge(r,i,n),G(i,o,n),O(n,o);continue}let l=kt(e,o,r,n);if(l){r=ge(r,l,n),G(l,o,n),O(n,o);continue}if(n.callbacks.beforeNodeAdded(o)===!1)return;t.insertBefore(o,r),n.callbacks.afterNodeAdded(o),O(n,o)}for(;r!==null;){let i=r;r=r.nextSibling,Se(i,n)}}function At(e,t){let n=e.nodeType;if(n===1){for(const s of e.attributes)t.getAttribute(s.name)!==s.value&&t.setAttribute(s.name,s.value);for(const s of t.attributes)e.hasAttribute(s.name)||t.removeAttribute(s.name)}if((n===Node.COMMENT_NODE||n===Node.TEXT_NODE)&&t.nodeValue!==e.nodeValue&&(t.nodeValue=e.nodeValue),e instanceof HTMLInputElement&&t instanceof HTMLInputElement&&e.type!=="file")t.value=e.value||"",z(e,t,"value"),z(e,t,"checked"),z(e,t,"disabled");else if(e instanceof HTMLOptionElement)z(e,t,"selected");else if(e instanceof HTMLTextAreaElement&&t instanceof HTMLTextAreaElement){const s=e.value,r=t.value;s!==r&&(t.value=s),t.firstChild&&t.firstChild.nodeValue!==s&&(t.firstChild.nodeValue=s)}}function z(e,t,n){const s=e.getAttribute(n),r=t.getAttribute(n);s!==r&&(s?t.setAttribute(n,s):t.removeAttribute(n))}function we(e,t,n){const s=[],r=[],o=[],i=[],l=n.head.style,u=new Map;for(const a of e.children)u.set(a.outerHTML,a);for(const a of t.children){let d=u.has(a.outerHTML),E=n.head.shouldReAppend(a),m=n.head.shouldPreserve(a);d||m?E?r.push(a):(u.delete(a.outerHTML),o.push(a)):l==="append"?E&&(r.push(a),i.push(a)):n.head.shouldRemove(a)!==!1&&r.push(a)}i.push(...u.values()),console.log("to append: ",i);const f=[];for(const a of i){console.log("adding: ",a);const d=document.createRange().createContextualFragment(a.outerHTML).firstChild;if(!d)throw new Error("could not create new element from: "+a.outerHTML);if(console.log(d),n.callbacks.beforeNodeAdded(d)){if(d.hasAttribute("href")||d.hasAttribute("src")){let E;const m=new Promise(h=>{E=h});d.addEventListener("load",function(){E(void 0)}),f.push(m)}t.appendChild(d),n.callbacks.afterNodeAdded(d),s.push(d)}}for(const a of r)n.callbacks.beforeNodeRemoved(a)!==!1&&(t.removeChild(a),n.callbacks.afterNodeRemoved(a));return n.head.afterHeadMorphed(t,{added:s,kept:o,removed:r}),f}function N(){}function Dt(e,t,n){return{target:e,newContent:t,config:n,morphStyle:n.morphStyle,ignoreActive:n.ignoreActive,idMap:$t(e,t),deadIds:new Set,callbacks:Object.assign({beforeNodeAdded:N,afterNodeAdded:N,beforeNodeMorphed:N,afterNodeMorphed:N,beforeNodeRemoved:N,afterNodeRemoved:N},n.callbacks),head:Object.assign({style:"merge",shouldPreserve:s=>s.getAttribute("im-preserve")==="true",shouldReAppend:s=>s.getAttribute("im-re-append")==="true",shouldRemove:N,afterHeadMorphed:N},n.head)}}function ve(e,t,n){return!e||!t?!1:e.nodeType===t.nodeType&&e.tagName===t.tagName?e?.id?.length&&e.id===t.id?!0:$(n,e,t)>0:!1}function B(e,t){return!e||!t?!1:e.nodeType===t.nodeType&&e.tagName===t.tagName}function ge(e,t,n){for(;e!==t;){const s=e;if(e=e?.nextSibling,!s)throw new Error("tempNode is null");Se(s,n)}return O(n,t),t.nextSibling}function Lt(e,t,n,s,r){const o=$(r,n,t);let i=null;if(o>0){i=s;let l=0;for(;i!=null;){if(ve(n,i,r))return i;if(l+=$(r,i,e),l>o)return null;i=i.nextSibling}}return i}function kt(e,t,n,s){let r=n,o=t.nextSibling,i=0;for(;r&&o;){if($(s,r,e)>0)return null;if(B(t,r))return r;if(B(o,r)&&(i++,o=o.nextSibling,i>=2))return null;r=r.nextSibling}return r}const be=new DOMParser;function Nt(e){const t=e.replace(/<svg(\s[^>]*>|>)([\s\S]*?)<\/svg>/gim,"");if(t.match(/<\/html>/)||t.match(/<\/head>/)||t.match(/<\/body>/)){const n=be.parseFromString(e,"text/html");if(t.match(/<\/html>/))return _.add(n),n;{let s=n.firstChild;return s?(_.add(s),s):null}}else{const s=be.parseFromString(`<body><template>${e}</template></body>`,"text/html").body.querySelector("template")?.content;if(!s)throw new Error("content is null");return _.add(s),s}}function Ct(e){if(e==null)return document.createElement("div");if(_.has(e))return e;if(e instanceof Node){const t=document.createElement("div");return t.append(e),t}else{const t=document.createElement("div");for(const n of[...e])t.append(n);return t}}function Ot(e,t,n){const s=[],r=[];for(;e;)s.push(e),e=e.previousSibling;for(;s.length>0;){const o=s.pop();r.push(o),t?.parentElement?.insertBefore(o,t)}for(r.push(t);n;)s.push(n),r.push(n),n=n.nextSibling;for(;s.length;)t?.parentElement?.insertBefore(s.pop(),t.nextSibling);return r}function Rt(e,t,n){let s=e.firstChild,r=s,o=0;for(;s;){let i=It(s,t,n);i>o&&(r=s,o=i),s=s.nextSibling}return r}function It(e,t,n){return B(e,t)?.5+$(n,e,t):0}function Se(e,t){O(t,e),t.callbacks.beforeNodeRemoved(e)!==!1&&(e.remove(),t.callbacks.afterNodeRemoved(e))}function Pt(e,t){return!e.deadIds.has(t)}function Ht(e,t,n){return e.idMap.get(n)?.has(t)||!1}function O(e,t){const n=e.idMap.get(t);if(n)for(const s of n)e.deadIds.add(s)}function $(e,t,n){const s=e.idMap.get(t);if(!s)return 0;let r=0;for(const o of s)Pt(e,o)&&Ht(e,o,n)&&++r;return r}function ye(e,t){const n=e.parentElement,s=e.querySelectorAll("[id]");for(const r of s){let o=r;for(;o!==n&&o;){let i=t.get(o);i==null&&(i=new Set,t.set(o,i)),i.add(r.id),o=o.parentElement}}}function $t(e,t){const n=new Map;return ye(e,n),ye(t,n),n}const qt=new DOMParser,Te="datastar",Q=`${Te}-indicator`,U=`${Te}-request`,Ft="Accept",Me="text/html",xt="Content-Type",_t="application/json",Gt="selector",zt="swap",ee="get",Ae=()=>q(ee),De="post",Le=()=>q(De),ke="put",Ne=()=>q(ke),Ce="patch",Oe=()=>q(Ce),Re="delete",Ie=()=>q(Re),Pe=()=>{Ae(),Le(),Ne(),Oe(),Ie()};let He=!1;function q(e){if(!He){const t=document.createElement("style");t.innerHTML=`
.${Q}{
  opacity:0;
  transition: opacity 500ms ease-in;
}
.${U} .${Q}{
    opacity:1
}
.${U}.${Q}{
    opacity:1
}
    `,document.head.appendChild(t),He=!0}bt({name:e,description:`turns @${e}(args) into fetch(${e}, args)`,fn:async t=>Bt(e,t)})}async function Bt(e,t){const{el:n,dataStack:s}=t,r=s.signals?.[e];if(!r)throw new Error(`No signal for ${e}`);const o=H(n);if(!o)throw new Error("Element must be an HTMLElement or SVGElement");o.classList.add(U);const i=new URL(r.value,window.location.origin),l=new Headers;if(l.append(Ft,Me),l.append(xt,_t),s?.headers)for(let m in s.headers){const h=s.headers[m];l.append(m,h.value)}const u=JSON.stringify(s,(m,h)=>h instanceof ae?h.isEffect?void 0:h.get():h),f={method:e,headers:l};if(e===ee){const m=new URLSearchParams(i.search);m.append("dataStack",u),i.search=m.toString()}else f.body=u;const a=await fetch(i,f);if(!a.ok)throw new Error("Network response was not ok.");const d=await a.text(),E=[...qt.parseFromString(d,Me).body.children];for(let m=0;m<E.length;m++){const h=E[m];if(!(h instanceof Element))throw new Error("Not an element");const y=H(h),T=h.getAttribute("id"),A=m===0,D=!!T?.length,M=A&&!D;let w;if(M)w=[n];else{if(!D)throw new Error("No id");const p=y?.dataset?.[Gt]||`#${T}`;w=document.querySelectorAll(p)||[]}if(!w)throw new Error("No target element");for(const p of w)switch(y?.dataset?.[zt]||"morph"){case"morph":Mt(p,h);break;case"inner":p.innerHTML=h.innerHTML;break;case"outer":p.outerHTML=h.outerHTML;break;case"prepend":p.prepend(h.outerHTML);break;case"append":p.append(h.outerHTML);break;case"before":p.before(h);break;case"after":p.after(h);break;case"delete":p.remove();break;default:throw new Error("Invalid merge mode")}}o.classList.remove(U)}const Ut="model",$e=["change","input","keydown"];function jt(){b(Ut,{allowedTags:["input","textarea","select"],requiredExtensions:[S],withExpression:({name:e,el:t,expression:n,dataStack:s,reactivity:{effect:r,onCleanup:o}})=>{const i=s.signals[n];if(!i)throw new Error(`Signal ${n} not found`);if(!("value"in t))throw new Error("Element must have a value property");t.value=i.value;const l=()=>{const u=i.value;if(typeof u=="number")i.value=Number(t.value);else if(typeof u=="string")i.value=t.value;else if(typeof u=="boolean")i.value=!!t.value;else throw new Error("Unsupported type")};return{model:{[`${e}-${yt()}`]:r(()=>{t.value=i.value;for(const u of $e)t.addEventListener(u,l);o(()=>{for(const u of $e)t.removeEventListener(u,l)})})}}}})}const qe="on",Fe="once",xe="throttle",_e="debounce",Ge="leading";function ze(){b(qe,{requiredExtensions:[S],allowedModifiers:[Fe,xe,_e,Ge],withExpression:({el:e,name:t,hasMod:n,withMod:s,expression:r,dataStack:o,reactivity:{computed:i,effect:l,onCleanup:u},actions:f})=>{const a=L(r),d=n(Fe),E=s(xe),m=s(_e),h=n(Ge);if(t==="load"){document.addEventListener("DOMContentLoaded",()=>a(e,o,f),!0);return}const y=()=>a(e,o,f);let T=y,A;if(d)T=()=>{y(),A&&e.removeEventListener(t,A)};else if(E){const[M]=E.args,w=M?Number(M):1e3;let p=0;const I=i(()=>{const se=Date.now();if(se-p>=w)return p=se,y()});T=()=>I.value}else if(m){const[M]=m.args,w=M?Number(M):1e3;let p;const I=i(()=>{h&&!p&&y(),clearTimeout(p),p=setTimeout(()=>{h?p=void 0:y()},w)});T=()=>I.value}return A=()=>T(),e.addEventListener(t,A),{on:{[t]:l(()=>{u(()=>{d||e.removeEventListener(t,A)})})}}}})}const Be="ref";function Ue(){b(Be,{requiredExtensions:[S],preprocessExpressions:[{name:"ref",description:"turns #ref into data.refs.ref.value",regexp:new RegExp(/(?<whole>\#(?<ref>[a-zA-Z_$][0-9a-zA-Z_$]*))/g),replacer:({ref:e})=>`data.refs.${e}.value`}],withExpression:({el:e,name:t,reactivity:{signal:n}})=>({refs:{[t]:n(e)}})})}const te="important",ne="display",je="none",Ve="show";function We(){b(Ve,{requiredExtensions:[S],allowedModifiers:[te],withExpression:({el:e,name:t,dataStack:n,expression:s,hasMod:r,reactivity:{effect:o},actions:i})=>{const l=L(s);if(!(e instanceof HTMLElement||e instanceof SVGElement))throw new Error("Element must have a style property");const f=r(te)?te:void 0;return{show:{[t]:o(()=>{!!l(e,n,i)?e.style.length===1&&e.style.display===je?e.style.removeProperty(ne):e.style.setProperty(ne,"",f):e.style.setProperty(ne,je,f)})}}}})}const S="signal",Ze="persist";function Je(){b(S,{requiredExtensions:[Y],preprocessExpressions:[{name:"signal",description:"turns $signal into dataStack.signals.signal.value",regexp:new RegExp(/(?<whole>\$(?<signal>[a-zA-Z_$][0-9a-zA-Z_$]*))/g),replacer:({signal:e})=>`dataStack.${S}s.${e}.value`}],allowedModifiers:[Ze],withExpression:({name:e,el:t,expression:n,reactivity:s,hasMod:r,actions:o})=>{const i=s.signal(re(t,{},o,n));if(r(Ze)){const l=localStorage.getItem(e);if(l){const u=JSON.parse(l);i.value=u}s.effect(()=>{const u=JSON.stringify(i.value);localStorage.setItem(e,u)})}return{signals:{[e]:i}}}})}const Xe="prepend",Ke="append",Ye="Target element must have a parent if using prepend or append",Qe="teleport";function et(){b(Qe,{requiredExtensions:[S],allowedModifiers:[Xe,Ke],withExpression:({name:e,el:t,expression:n,dataStack:s,reactivity:{effect:r},hasMod:o,actions:i})=>{if(!(t instanceof HTMLTemplateElement))throw new Error("Element must be a template");const l=L(n);return{text:{[e]:r(()=>{const f=l(t,s,i);if(typeof f!="string")throw new Error("Selector must be a string");const a=document.querySelector(f);if(!a)throw new Error(`Target element not found: ${f}`);if(!t.content)throw new Error("Template element must have content");const d=t.content.cloneNode(!0);if(H(d)?.firstElementChild)throw new Error("Empty template");if(o(Xe)){if(!a.parentNode)throw new Error(Ye);a.parentNode.insertBefore(d,a)}else if(o(Ke)){if(!a.parentNode)throw new Error(Ye);a.parentNode.insertBefore(d,a.nextSibling)}else a.appendChild(d);a.appendChild(d)})}}}})}const tt="text";function nt(){b(tt,{withExpression:({name:e,el:t,expression:n,dataStack:s,actions:r,reactivity:{effect:o}})=>{const i=L(n);return{text:{[e]:o(()=>{if(!s?.signals)return;const u=i(t,s,r);t.textContent=`${u}`})}}}})}const st="once",rt="full",ot="half",it="intersects";function Vt(){b(it,{requiredExtensions:[S],allowedModifiers:[st,rt,ot],withExpression:({name:e,el:t,expression:n,dataStack:s,actions:r,hasMod:o,reactivity:{effect:i,onCleanup:l}})=>{const u=L(n),f=()=>u(t,s,r),a={threshold:0};o(rt)?a.threshold=1:o(ot)&&(a.threshold=.5);const d=new IntersectionObserver(m=>{m.forEach(h=>{h.isIntersecting&&(f(),o(st)&&d.disconnect())})},a);return{on:{[e]:i(()=>{d.observe(t),l(()=>{d.disconnect()})})}}}})}function Wt(){Tt(),Je(),de(),jt(),pe(),Pe(),ze(),Ue(),We(),et(),nt()}function Zt(e){console.warn("Overriding fetch with mock version, this should only be used in examples.");const t=async(n,s)=>{const r=new Request(n,s);if(!(n instanceof URL))throw new Error("url must be a URL");const o=e[n.pathname];if(!o)throw new Error(`No mock route found for ${r.url}`);const i=o[r.method];if(!i)throw new Error(`No mock route found for ${r.method} ${r.url}`);let{html:l,status:u,statusText:f,headers:a}=await i(r);return a||(a=new Headers),a.has("Content-Type")||a.append("Content-Type","text/html"),u=u||200,f=f||"OK",new Response(l,{status:u,statusText:f,headers:a})};window.fetch=t}c.BIND=fe,c.DELETE=Re,c.FOCUS=he,c.GET=ee,c.INTERSECTS=it,c.ON=qe,c.PATCH=Ce,c.POST=De,c.PUT=ke,c.REF=Be,c.SHOW=Ve,c.SIGNAL=S,c.TELEPORT=Qe,c.TEXT=tt,c.addAllFragmentExtensions=Pe,c.addAllIncludedExtensions=Wt,c.addBindDataExtension=de,c.addDeleteExtension=Ie,c.addFocusDataExtension=pe,c.addGetExtension=Ae,c.addIntersectsExtension=Vt,c.addOnDataExtension=ze,c.addPatchExtension=Oe,c.addPostExtension=Le,c.addPutExtension=Ne,c.addRefDataExtension=Ue,c.addShowDataExtension=We,c.addSignalDataExtension=Je,c.addTeleportDataExtension=et,c.addTextDataExtension=nt,c.camelize=oe,c.functionEval=re,c.functionGenerator=L,c.injectMockFetch=Zt,c.walkDownDOM=C,c.walkUpDOM=j,Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=datastar.umd.cjs.map
